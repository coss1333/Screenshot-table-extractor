# Программа: извлечение таблиц со скриншотов → Excel

Этот инструмент берёт изображения (скриншоты) из папки и превращает найденные на них таблицы в один Excel‑файл. Работает на Windows, macOS и Linux. Оптимизирован под русско‑/англоязычные скриншоты.

## Возможности
- Обрабатывает PNG/JPG/JPEG/PDF (страничные) файлы из указанной папки
- Находит таблицы на картинках (структурное распознавание)
- Рисует рамки и сохраняет извлечённые таблицы в **один Excel** (`output.xlsx`) или по листу на каждую таблицу
- Если таблица не найдена, делает построчный OCR и сохраняет текст на отдельный лист
- Поддержка нескольких языков OCR (по умолчанию `ru,en`)

## Быстрый старт (Windows)
1. Установите **Python 3.10–3.12**: https://www.python.org/downloads/
2. В проводнике откройте папку проекта, затем запустите PowerShell и выполните:
   ```powershell
   python -m venv .venv
   .\.venv\Scripts\Activate.ps1
   pip install --upgrade pip
   pip install -r requirements.txt
   ```
   > При первом запуске модели будут автоматически скачаны (несколько сотен МБ).
3. Положите скриншоты в папку `input/` (создана в проекте).
4. Запустите обработку:
   ```powershell
   python main.py --input input --output output.xlsx --langs ru,en
   ```
5. Результат: `output.xlsx` (в корне проекта). Также в `runs/` появятся HTML‑превью и рамки детекции.

## macOS / Linux
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
python main.py --input input --output output.xlsx --langs ru,en
```

## Параметры запуска
```bash
python main.py --input ./input --output ./output.xlsx --langs ru,en --sheet-mode one-per-table
```
- `--input` — папка с изображениями (png, jpg, jpeg, pdf);
- `--output` — путь к результирующему Excel;
- `--langs` — языки распознавания (через запятую), например `ru,en` или `en`;
- `--sheet-mode` — как складывать листы в Excel:  
  - `one-per-table` (по умолчанию) — каждый найденный фрагмент‑таблица в свой лист;  
  - `append` — всё в один лист с колонкой `source` (имя файла).

## Требования и примечания
- Используется **PaddleOCR (PP‑Structure)** для распознавания таблиц и текста (CPU). Никаких внешних утилит (Tesseract) не требуется.
- Первичная загрузка моделей (табличная разметка/распознавание) займёт время и место на диске.
- Если таблицы сильно «грязные» (сканы низкого качества), попробуйте предварительную обработку (контраст/бинаризация). Простейший препроцесс включён по умолчанию.

## Примеры
```powershell
python main.py --input input --output output.xlsx
python main.py --input scans --output result.xlsx --langs ru,en --sheet-mode append
```

## Структура проекта
```
screenshot_table_extractor/
├─ main.py
├─ requirements.txt
├─ README_ru.md
├─ input/           # сюда кладите скриншоты
└─ runs/            # сюда сохраняются промежуточные материалы (html, разметка)
```

## Частые вопросы
**Q:** Изображения без чётких линий таблицы плохо распознаются.  
**A:** Включён алгоритм поиска таблиц PP‑Structure; он не требует идеальных линий, но качество влияет. Если столбцы «плавают», используйте `--sheet-mode append` и дальше чистите данные в Excel.

**Q:** Можно ли извлекать данные с PDF?  
**A:** Да, постраничные PDF поддерживаются (растрилизация страниц). Просто положите PDF в `input/`.

**Q:** Можно ли ограничить число файлов?  
**A:** Да, используйте `--max-files 50`.

---

© Вы можете свободно изменять и распространять этот код внутри своей команды.
